@page "/"
@inject IBarberService BarberService
@inject NavigationManager Navigation

<PageTitle>SmartCut Scheduler - Home</PageTitle>

<MudContainer MaxWidth="MaxWidth.Large" Class="mt-8">
    <MudText Typo="Typo.h3" Align="Align.Center" GutterBottom="true">
        Bine ai venit la SmartCut Scheduler
    </MudText>
    <MudText Typo="Typo.body1" Align="Align.Center" Color="Color.Secondary" Class="mb-8">
        Alege un frizer și programează-te online
    </MudText>

    @if (_loading)
    {
        <MudProgressCircular Color="Color.Primary" Indeterminate="true" />
    }
    else if (_barbers.Any())
    {
        <MudGrid>
            @foreach (var barber in _barbers)
            {
                <MudItem xs="12" sm="6" md="4">
                    <MudCard Class="barber-card d-flex flex-column" Style="height: 100%;">
                        <MudCardMedia Image="@(barber.PhotoUrl ?? "/images/default-barber.jpg")" Height="200" />
                        <MudCardContent Class="flex-grow-1">
                            <MudText Typo="Typo.h5">@barber.Name</MudText>
                            <MudText Typo="Typo.body2" Color="Color.Secondary">@barber.Description</MudText>
                            <MudChip T="string" Color="Color.Success" Size="Size.Small" Class="mt-2">
                                @barber.Services.Count servicii disponibile
                            </MudChip>
                        </MudCardContent>
                        <MudCardActions>
                            <MudButton Variant="Variant.Text" Color="Color.Primary" OnClick="() => NavigateToBarberCalendar(barber.Id)">
                                Vezi calendar
                            </MudButton>
                        </MudCardActions>
                    </MudCard>
                </MudItem>
            }
        </MudGrid>
    }
    else
    {
        <MudAlert Severity="Severity.Info">
            Nu sunt frizeri disponibili momentan.
        </MudAlert>
    }
</MudContainer>

@code {
    private List<BarberDto> _barbers = new();
    private bool _loading = true;

    protected override async Task OnInitializedAsync()
    {
        await LoadBarbersAsync();
    }

    private async Task LoadBarbersAsync()
    {
        _loading = true;
        try
        {
            _barbers = await BarberService.GetAllBarbersAsync();
        }
        catch (Exception ex)
        {
            Console.WriteLine($"Error loading barbers: {ex.Message}");
        }
        finally
        {
            _loading = false;
        }
    }

    private void NavigateToBarberCalendar(Guid barberId)
    {
        Navigation.NavigateTo($"/barber/{barberId}");
    }
}

<style>
    .hover-card {
        transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
    }

    .hover-card:hover {
        transform: translateY(-4px);
        box-shadow: 0 8px 16px rgba(0,0,0,0.2);
    }

    .cursor-pointer {
        cursor: pointer;
    }
</style>

